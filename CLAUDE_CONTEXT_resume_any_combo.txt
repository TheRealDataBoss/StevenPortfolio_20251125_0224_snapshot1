=== HEADERS: /resume/preview/ (iframe must be allowed) ===
: application/pdf
: same-origin
: WSGIServer/0.2 CPython/3.13.12
: Wed, 11 Feb 2026 00:42:08 GMT
: DENY
: inline; filename="Steven_Wazlavek_Resume.pdf"
: same-origin
: nosniff

=== KEY FILES (full content) ===

--- core\settings.py ---
from pathlib import Path
import os

BASE_DIR = Path(__file__).resolve().parent.parent

SECRET_KEY = "dev-secret-key-change-me"
DEBUG = True
ALLOWED_HOSTS = ["127.0.0.1", "localhost", "testserver"]

INSTALLED_APPS = [
    "jazzmin",
    "django.contrib.admin",
    "django.contrib.auth",
    "django.contrib.contenttypes",
    "django.contrib.sessions",
    "django.contrib.messages",
    "django.contrib.staticfiles",
    "portfolio",
]

MIDDLEWARE = [
    "django.middleware.security.SecurityMiddleware",
    "django.contrib.sessions.middleware.SessionMiddleware",
    "django.middleware.common.CommonMiddleware",
    "django.middleware.csrf.CsrfViewMiddleware",
    "django.contrib.auth.middleware.AuthenticationMiddleware",
    "django.contrib.messages.middleware.MessageMiddleware",
    "django.middleware.clickjacking.XFrameOptionsMiddleware",
]

ROOT_URLCONF = "core.urls"

TEMPLATES = [
    {
        "BACKEND": "django.template.backends.django.DjangoTemplates",
        "DIRS": [BASE_DIR / "templates"],
        "APP_DIRS": True,
        "OPTIONS": {
            "context_processors": [
                "django.template.context_processors.debug",
                "django.template.context_processors.request",
                "django.contrib.auth.context_processors.auth",
                "django.contrib.messages.context_processors.messages",
                "portfolio.context_processors.navigation",
            ],
        },
    },
]

WSGI_APPLICATION = "core.wsgi.application"

DATABASES = {
    "default": {
        "ENGINE": "django.db.backends.sqlite3",
        "NAME": BASE_DIR / "db.sqlite3",
    }
}

AUTH_PASSWORD_VALIDATORS = [
    {"NAME": "django.contrib.auth.password_validation.UserAttributeSimilarityValidator"},
    {"NAME": "django.contrib.auth.password_validation.MinimumLengthValidator"},
    {"NAME": "django.contrib.auth.password_validation.CommonPasswordValidator"},
    {"NAME": "django.contrib.auth.password_validation.NumericPasswordValidator"},
]

LANGUAGE_CODE = "en-us"
TIME_ZONE = "UTC"
USE_I18N = True
USE_TZ = True

STATIC_URL = "/static/"
STATICFILES_DIRS = [BASE_DIR / "static"]
STATIC_ROOT = BASE_DIR / "staticfiles"

MEDIA_URL = "/media/"
MEDIA_ROOT = BASE_DIR / "media"

DEFAULT_AUTO_FIELD = "django.db.models.BigAutoField"




--- portfolio\views.py ---
from django.contrib import messages
from django.db.models import Q
from django.http import FileResponse, Http404
from django.shortcuts import redirect, render
from django.views.generic import TemplateView, ListView, DetailView

from .forms import ContactForm
from .models import Category, Project, Resume, SiteSetting


def resume_pdf_inline(request):
    resume = Resume.objects.filter(is_primary=True).order_by("-updated_at", "-id").first()
    if not resume:
        raise Http404
    if resume.preview_pdf:
        pdf_file = resume.preview_pdf
    elif resume.file and resume.file.name.lower().endswith(".pdf"):
        pdf_file = resume.file
    else:
        raise Http404
    response = FileResponse(pdf_file.open(), content_type="application/pdf")
    response["Content-Disposition"] = 'inline; filename="Steven_Wazlavek_Resume.pdf"'
    return response


class HomeView(TemplateView):
    template_name = "portfolio/home.html"

    def get_context_data(self, **kwargs):
        context = super().get_context_data(**kwargs)
        context["settings"] = SiteSetting.objects.first()
        context["featured_projects"] = Project.objects.filter(is_featured=True)[:3]
        context["recent_projects"] = Project.objects.order_by("-created_at")[:6]
        context["categories"] = Category.objects.all()
        return context


class ProjectListView(ListView):
    model = Project
    template_name = "portfolio/project_list.html"
    context_object_name = "projects"
    paginate_by = 9

    def get_queryset(self):
        qs = Project.objects.select_related("category").all()
        cat = self.request.GET.get("category")
        q = self.request.GET.get("q")
        if cat:
            qs = qs.filter(category__slug=cat)
        if q:
            qs = qs.filter(
                Q(title__icontains=q)
                | Q(description__icontains=q)
                | Q(tags__icontains=q)
                | Q(category__name__icontains=q)
            )
        return qs

    def get_context_data(self, **kwargs):
        ctx = super().get_context_data(**kwargs)
        ctx["categories"] = Category.objects.all()
        ctx["current_category"] = self.request.GET.get("category")
        ctx["search_term"] = self.request.GET.get("q", "")
        return ctx


class ProjectDetailView(DetailView):
    model = Project
    slug_field = "slug"
    template_name = "portfolio/project_detail.html"
    context_object_name = "project"

    def get_context_data(self, **kwargs):
        ctx = super().get_context_data(**kwargs)
        ctx["related"] = (
            Project.objects.filter(category=self.object.category)
            .exclude(pk=self.object.pk)
            .order_by("-created_at")[:3]
        )
        return ctx


class AboutView(TemplateView):
    template_name = "portfolio/about.html"

    def get_context_data(self, **kwargs):
        ctx = super().get_context_data(**kwargs)
        ctx["settings"] = SiteSetting.objects.first()
        return ctx


class ResumeView(TemplateView):
    template_name = "portfolio/resume.html"

    def get_context_data(self, **kwargs):
        ctx = super().get_context_data(**kwargs)
        ctx["latest_resume"] = Resume.objects.first()
        ctx["resume_entries"] = Resume.objects.all()
        return ctx


class ContactView(TemplateView):
    template_name = "portfolio/contact.html"

    def get(self, request, *args, **kwargs):
        return render(request, self.template_name, {"form": ContactForm()})

    def post(self, request, *args, **kwargs):
        form = ContactForm(request.POST)
        if form.is_valid():
            form.save()
            messages.success(request, "Thanks for reaching out! I'll respond soon.")
            return redirect("portfolio:contact")
        messages.error(request, "Please correct the errors below.")
        return render(request, self.template_name, {"form": form})


--- portfolio\models.py ---
from django.db import models
from django.urls import reverse
from django.utils.text import slugify
from django.core.validators import RegexValidator

HEX_COLOR_VALIDATOR = RegexValidator(
    regex=r'^#(?:[0-9a-fA-F]{3}){1,2}$',
    message='Enter a valid hex color, e.g. #00aaff'
)

THEME_CHOICES = (
    ("light", "Light"),
    ("dark", "Dark"),
    ("blue", "Blue"),
    ("green", "Green"),
    ("purple", "Purple"),
)

class Category(models.Model):
    name = models.CharField(max_length=120, unique=True)
    slug = models.SlugField(max_length=140, unique=True, blank=True)
    description = models.TextField(blank=True)

    class Meta:
        ordering = ["name"]
        verbose_name_plural = "Categories"

    def save(self, *args, **kwargs):
        if not self.slug:
            self.slug = slugify(self.name)
        super().save(*args, **kwargs)

    def __str__(self) -> str:
        return self.name

    def get_absolute_url(self):
        return reverse("portfolio:project_list") + f"?category={self.slug}"


class Project(models.Model):
    title = models.CharField(max_length=200)
    slug = models.SlugField(max_length=220, unique=True, blank=True)
    category = models.ForeignKey(Category, related_name="projects", on_delete=models.CASCADE)
    summary = models.CharField(max_length=255, blank=True)
    description = models.TextField()
    image = models.ImageField(upload_to="projects/images/", blank=True, null=True)
    attachment = models.FileField(upload_to="projects/files/", blank=True, null=True)
    tags = models.CharField(max_length=255, blank=True, help_text="Comma-separated keywords")
    is_featured = models.BooleanField(default=False)
    created_at = models.DateTimeField(auto_now_add=True)
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        ordering = ["-created_at"]

    def save(self, *args, **kwargs):
        if not self.slug:
            self.slug = slugify(self.title)
        super().save(*args, **kwargs)

    def __str__(self) -> str:
        return self.title

    def get_absolute_url(self):
        return reverse("portfolio:project_detail", args=[self.slug])


class SiteSetting(models.Model):
    hero_title = models.CharField(max_length=180, default="Welcome to my portfolio")
    hero_subtitle = models.CharField(max_length=255, blank=True)
    hero_image = models.ImageField(upload_to="site/hero/", blank=True, null=True)
    about_title = models.CharField(max_length=180, default="About Me")
    about_body = models.TextField(blank=True)
    resume_file = models.FileField(upload_to="resumes/", blank=True, null=True, help_text="Upload a resume PDF for site-wide download link")

    # theme choice retained for quick presets
    theme = models.CharField(max_length=20, choices=THEME_CHOICES, default="light", help_text="Visual theme preset")

    # Per-color fields (hex strings). Use HTML5 color pickers in admin.
    primary_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#0d6efd", help_text="Primary brand color (hex)")
    button_text_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#ffffff")
    nav_bg_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#0b1220")
    nav_text_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#ffffff")
    hero_start_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#0d6efd")
    hero_end_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#6f42c1")
    hero_text_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#ffffff")
    footer_bg_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#0f172a")
    footer_text_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#cbd5e1")
    page_bg_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#f8fafc")
    text_color = models.CharField(max_length=7, validators=[HEX_COLOR_VALIDATOR], default="#0f172a")

    class Meta:
        verbose_name = "Site setting"
        verbose_name_plural = "Site settings"

    def __str__(self) -> str:
        return "Site Settings"


class Resume(models.Model):
    category = models.CharField(
        max_length=50,
        default="general",
        help_text="Category label, e.g. general/finance/marketing."
    )
    is_primary = models.BooleanField(
        default=False,
        help_text="If true, this resume is the primary one for its category."
    )
    title = models.CharField(max_length=200)
    file = models.FileField(upload_to="resumes/")
    preview_pdf = models.FileField(upload_to="resumes/previews/", blank=True, null=True, help_text="Optional PDF for inline preview (use when main file is DOCX)")
    updated_at = models.DateTimeField(auto_now=True)

    class Meta:
        ordering = ["-updated_at"]

    def __str__(self) -> str:
        return self.title


class ContactMessage(models.Model):
    name = models.CharField(max_length=120)
    email = models.EmailField()
    subject = models.CharField(max_length=150)
    message = models.TextField()
    created_at = models.DateTimeField(auto_now_add=True)

    class Meta:
        ordering = ["-created_at"]

    def __str__(self) -> str:
        return f"Message from {self.name}: {self.subject}"


# ---- NavItem: editable navigation entries ----
from django.contrib.auth.models import Group
from django.db.models.signals import post_save, post_delete
from django.dispatch import receiver
from django.core.cache import cache

class NavItem(models.Model):
    title = models.CharField(max_length=120)
    url = models.CharField(max_length=255, blank=True, help_text="Relative (e.g., /about/) or absolute URL (https://...)")
    parent = models.ForeignKey("self", null=True, blank=True, related_name="children", on_delete=models.CASCADE)
    order = models.PositiveIntegerField(default=0, db_index=True)
    visible = models.BooleanField(default=True)
    external = models.BooleanField(default=False, help_text="Treat url as external")
    new_tab = models.BooleanField(default=False, help_text="Open in new tab")
    login_required = models.BooleanField(default=False, help_text="Show only to authenticated users")
    allowed_groups = models.ManyToManyField(Group, blank=True, help_text="If set, only members of these groups see the item")
    icon = models.CharField(max_length=64, blank=True, help_text="Optional icon class (fontawesome)")

    class Meta:
        ordering = ("order", "title")
        verbose_name = "Navigation item"
        verbose_name_plural = "Navigation items"

    def __str__(self):
        return self.title

    def get_link(self):
        return self.url or "#"

# Clear nav cache after changes
@receiver([post_save, post_delete], sender=NavItem)
def _clear_nav_cache(sender, **kwargs):
    try:
        cache.delete('nav_items_v1')
    except:
        pass



--- portfolio\urls.py ---
from django.urls import path
from . import views

app_name = "portfolio"

urlpatterns = [
    path("", views.HomeView.as_view(), name="home"),
    path("projects/", views.ProjectListView.as_view(), name="project_list"),
    path("projects/<slug:slug>/", views.ProjectDetailView.as_view(), name="project_detail"),
    path("about/", views.AboutView.as_view(), name="about"),
    path("resume/preview/", views.resume_pdf_inline, name="resume_pdf_inline"),
    path("resume/", views.ResumeView.as_view(), name="resume"),
    path("contact/", views.ContactView.as_view(), name="contact"),
]


--- templates\portfolio\resume.html ---
{% extends "portfolio/base.html" %}
{% block title %}Resume - Steven Wazlavek | Data Analyst{% endblock %}

{% block extra_head %}
<meta name="description" content="Steven Wazlavek - Data Analyst transitioning to Data Scientist. Resume with experience in Python, SQL, data visualization, machine learning. Kennesaw State University, MIT IDSS, Harvard Business School Online, Wharton.">
<script type="application/ld+json">
{
  "@context": "https://schema.org",
  "@type": "Person",
  "name": "Steven Wazlavek",
  "jobTitle": "Data Analyst (transitioning to Data Scientist)",
  "url": "/",
  "sameAs": [
    "https://github.com/TheRealDataBoss",
    "https://www.linkedin.com/in/databoss/"
  ],
  "alumniOf": [
    {"@type": "CollegeOrUniversity", "name": "Kennesaw State University"},
    {"@type": "CollegeOrUniversity", "name": "University of Alabama Manderson Graduate School of Business"},
    {"@type": "CollegeOrUniversity", "name": "MIT Institute for Data, Systems, and Society (IDSS)"},
    {"@type": "CollegeOrUniversity", "name": "Harvard Business School Online"},
    {"@type": "CollegeOrUniversity", "name": "The Wharton School, University of Pennsylvania"}
  ]
}
</script>
{% endblock %}

{% block content %}
<section class="py-5 bg-light">
    <div class="container">
        <div class="d-flex justify-content-between align-items-center mb-4">
            <div>
                <p class="text-uppercase text-primary fw-semibold mb-1">Resume</p>
                <h1 class="h3 mb-0">Steven Wazlavek</h1>
            </div>
            {% if primary_resume and primary_resume.file %}
                <a class="btn btn-primary" href="{{ primary_resume.file.url }}" target="_blank" rel="noopener">
                    <i class="fas fa-download me-1"></i> Download Resume
                </a>
            {% elif site_settings.resume_file %}
                <a class="btn btn-primary" href="{{ site_settings.resume_file.url }}" target="_blank" rel="noopener">
                    <i class="fas fa-download me-1"></i> Download Resume
                </a>
            {% endif %}
        </div>

        {% if primary_resume %}
            <div class="card shadow-sm border-0 mb-4">
                <div class="card-body">
                    <h5 class="card-title mb-2">{{ primary_resume.title }}</h5>
                    <p class="text-muted mb-0">
                        {{ primary_resume.category|title }} &middot;
                        Last updated {{ primary_resume.updated_at|date:"M d, Y" }}
                    </p>
                </div>
            </div>
        {% elif not site_settings.resume_file %}
            <div class="alert alert-info">
                No resume uploaded yet. Add one in
                <a href="/admin/portfolio/resume/add/">Admin &rarr; Resumes</a>
                and mark it as primary.
            </div>
        {% endif %}

        {% if primary_resume and primary_resume.preview_pdf or primary_resume and primary_resume.file.name and primary_resume.file.name|lower|slice:"-4:" == ".pdf" %}
            <div class="d-flex gap-2 mb-3">
                <a class="btn btn-outline-secondary btn-sm" href="{% url 'portfolio:resume_pdf_inline' %}" target="_blank" rel="noopener">
                    <i class="fas fa-external-link-alt me-1"></i> Open PDF in new tab
                </a>
                <button class="btn btn-outline-secondary btn-sm" id="printResumeBtn" type="button">
                    <i class="fas fa-print me-1"></i> Print
                </button>
            </div>
            <div class="mb-4">
                <iframe id="resumePdfFrame" src="{% url 'portfolio:resume_pdf_inline' %}#toolbar=1&navpanes=0&view=FitH" width="100%" height="900" style="border:1px solid #dee2e6; border-radius:.375rem;"></iframe>
                <p class="text-muted small mt-2">
                    <i class="fas fa-info-circle me-1"></i>
                    Page navigation is available via your browser's built-in PDF viewer toolbar.
                </p>
            </div>
        {% elif primary_resume %}
            <div class="alert alert-secondary">
                <i class="fas fa-info-circle me-1"></i>
                Upload a PDF preview in <a href="/admin/portfolio/resume/">Admin &rarr; Resumes</a> to enable inline display.
                {% if primary_resume.file %}The DOCX download is still available above.{% endif %}
            </div>
        {% endif %}

        <h2 class="h5 mt-4">History</h2>
        <ul class="list-group list-group-flush">
            {% for resume in resume_entries %}
                <li class="list-group-item d-flex justify-content-between align-items-center">
                    <span>{{ resume.title }}</span>
                    <div class="d-flex align-items-center gap-3">
                        <span class="text-muted small">{{ resume.updated_at|date:"M d, Y" }}</span>
                        <a href="{{ resume.file.url }}" class="btn btn-sm btn-outline-secondary">Download</a>
                    </div>
                </li>
            {% empty %}
                <li class="list-group-item text-muted">Upload your first resume to populate this list.</li>
            {% endfor %}
        </ul>
    </div>
</section>
{% endblock %}

{% block extra_js %}
<script>
(function() {
    var btn = document.getElementById('printResumeBtn');
    if (!btn) return;
    btn.addEventListener('click', function() {
        var frame = document.getElementById('resumePdfFrame');
        if (!frame) return;
        try {
            frame.contentWindow.focus();
            frame.contentWindow.print();
        } catch (e) {
            window.open(frame.src, '_blank');
        }
    });
})();
</script>
{% endblock %}


--- templates\portfolio\_nav.html ---
{# Render nested nav_items from context_processor #}
<ul class="navbar-nav ms-auto mb-2 mb-lg-0">
  {% for item in nav_items %}
    {% if item.children.all %}
      <li class="nav-item dropdown">
        <a class="nav-link dropdown-toggle" href="{{ item.url }}" id="nav{{ forloop.counter }}" role="button" data-bs-toggle="dropdown" aria-expanded="false"
           {% if item.new_tab %} target="_blank" rel="noopener noreferrer"{% endif %}>
          {% if item.icon %}<i class="{{ item.icon }}"></i>{% endif %} {{ item.title }}
        </a>
        <ul class="dropdown-menu" aria-labelledby="nav{{ forloop.counter }}">
          {% for child in item.children.all %}
            <li><a class="dropdown-item" href="{{ child.url }}" {% if child.new_tab %} target="_blank" rel="noopener noreferrer"{% endif %}>{{ child.title }}</a></li>
          {% endfor %}
        </ul>
      </li>
    {% else %}
      <li class="nav-item">
        <a class="nav-link" href="{{ item.url }}" {% if item.new_tab %} target="_blank" rel="noopener noreferrer"{% endif %}>
          {% if item.icon %}<i class="{{ item.icon }}"></i>{% endif %} {{ item.title }}
        </a>
      </li>
    {% endif %}
  {% endfor %}
</ul>

